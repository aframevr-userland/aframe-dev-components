!function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){AFRAME.registerComponent("retain-camera",i(4)),AFRAME.registerComponent("axis",i(1)),AFRAME.registerComponent("bb",i(2)),AFRAME.registerComponent("recorder",i(3))},function(e,t){e.exports={schema:{size:{type:"number",default:1},windowSize:{type:"int",default:100},windowBackground:{type:"string",default:"rgb(3, 44, 113)"}},init:function(){var e=this.makeAxisHelper();this.axisHelper=e,this.isCamera=void 0!==this.el.getObject3D("camera"),this.isCamera?(this.makeAxisWindow(),this.axisScene.add(this.axisHelper)):this.el.object3D.add(e)},makeAxisWindow:function(){var e=new THREE.WebGLRenderer({alpha:!0}),t=e.domElement;e.setSize(this.data.windowSize,this.data.windowSize),t.style.position="absolute",t.style.background=this.data.windowBackground,t.style.bottom=0,t.style.left=0,t.style.zIndex=100,this.el.sceneEl.appendChild(t),this.axisRenderer=e;var i=new THREE.Scene;this.axisScene=i;var a=new THREE.PerspectiveCamera(20,1,1,1e3);a.position.set(0,0,10),this.axisCamera=a},makeAxisHelper:function(){var e=new THREE.AxisHelper(this.data.size);e.material.transparent=!0,e.material.depthTest=!1;var t=new THREE.ConeGeometry(.1,.2,8),i=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:16711879,depthTest:!1,transparent:!0}));i.rotation.z=-1.5708,i.position.x=this.data.size,e.add(i);var a=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:65451,depthTest:!1,transparent:!0}));a.position.y=this.data.size,e.add(a);var n=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:34303,depthTest:!1,transparent:!0}));return n.rotation.x=1.5708,n.position.z=this.data.size,e.add(n),e},tick:function(){if(this.isCamera){var e=this.el.sceneEl.camera.getWorldQuaternion();this.axisHelper.setRotationFromQuaternion(e.inverse()),this.axisRenderer.render(this.axisScene,this.axisCamera)}}}},function(e,t){e.exports={init:function(){var e=new THREE.BoxHelper(this.el.getObject3D("mesh"));this.el.object3D.add(e)}}},function(e,t){e.exports={schema:{framerate:{type:"number",default:24},postUrl:{type:"string"},mediaType:{type:"string",default:"mp4"},fileName:{type:"string",default:"preview"}},init:function(){var e=this.el.sceneEl;this.recording=!1,this.getSceneCanvas=new Promise(function(t){e.loaded&&t(e.canvas),e.addEventListener("loaded",function(){t(e.canvas)})}),this.getSceneCanvas.then(this.setupRecorder.bind(this))},setupRecorder:function(e){function t(){o?a():i(),o=!o}function i(){c.currentTime>0&&(c.pause(),c.src="",c.load(),l.style.visibility="hidden"),s=[],d.start(),document.body.appendChild(u),u.style.visibility="visible",u.innerHTML="Recording",h.innerHTML="Stop"}function a(){d.stop(),u.innerHTML="Finished!",setTimeout(function(){u.style.visibility="hidden"},2e3),h.innerHTML="Record"}function n(e){if(e.data.size>0){s.push(e.data);var t=new Blob(s,{type:"video/webm"}),i=URL.createObjectURL(t);c.autoplay=!0,c.loop=!0,c.src=i,c.play(),l.style.visibility="visible"}}var s=[],o=!1,r=e.captureStream(this.data.framerate),d=new MediaRecorder(r);d.ondataavailable=n;var l=document.createElement("div");l.style.cssText="position: absolute; top: 100px; left: 0px; visibility: hidden";var c=document.createElement("video");c.style.cssText="background: black;",c.width=320,c.height=240,l.appendChild(c);var p=document.createElement("button");p.style.cssText="display: block",p.innerHTML="Save",p.addEventListener("click",function(){var e=new XMLHttpRequest,t=new FormData;e.addEventListener("load",function(){console.log("Video posted to: ",this.data.postUrl)}.bind(this));var i=new Blob(s,{type:"video/"+this.data.mediaType});t.append("files",i,this.data.fileName+"."+this.data.mediaType),e.open("POST",this.data.postUrl,!0),e.send(t)}.bind(this)),l.appendChild(p),document.body.appendChild(l);var h=document.createElement("button");h.style.cssText="position: absolute; top: 0px; left: 0px;",h.innerHTML="Record",document.body.appendChild(h),h.addEventListener("click",t);var u=document.createElement("div");u.style.cssText="position: absolute; top: 20px; left: 0px; color: white; background: black; visibility: hidden; font-family: Helvetica, Arial, Sans-Serif; padding: 10px;"}}},function(e,t){e.exports={init:function(){var e=this.el;this.origCamera,window.addEventListener("beforeunload",function(){var t=e.camera.el,i=t.getAttribute("position"),a=t.getAttribute("rotation");localStorage.setItem("a-frame-camera",JSON.stringify({position:i,rotation:a}))},!1),e.addEventListener("loaded",this.onLoaded.bind(this)),window.addEventListener("keydown",function(e){if("`"===e.key){var t=this.origCamera;this.setCamera(t.position,t.rotation)}}.bind(this))},onLoaded:function(){if(!this.el.camera)return void setTimeout(function(){this.onLoaded.call(this)}.bind(this),10);var e=this.el.camera.el;this.origCamera={position:e.getAttribute("position"),rotation:e.getAttribute("rotation")};var t=localStorage["a-frame-camera"],i=JSON.parse(t);e.setAttribute("position",i.position),e.setAttribute("rotation",i.rotation)},setCamera:function(e,t){var i=this.el.camera.el;i.setAttribute("position",e),i.setAttribute("rotation",t)}}}]);